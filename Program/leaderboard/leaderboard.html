<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="leaderboard.css">

</head>

<body>

    <h1>The Cloud Leaderboard</h1>
    <button class="Edit" id="add-test">Add Person</button>
    <div class="form-wrapper hidden">

        <input class="form-control" type="text" id="test-name" placeholder="Name...">

        <input class="form-control" type="text" id="test-result" placeholder="Points...">
        <button class="Edit" id="create-test">Add</button>
    </div>
    <div> <input id="search-input" class="search" type="text" placeholder="Search..."></div>
    <table class="table">

        <tr class="content">
            <th data-column="rank" data-order="desc">Rank &#9650</th>
            <th data-column="name" data-order="desc">Name &#9650</th>
            <th data-column="points" data-order="desc">Points &#9650</th>
        </tr>

        <tbody id="myTable">

        </tbody>
    </table>

    <script>
        var newId = 4
        var newTest = {
            'name': null,
            'id': newId,
            'result': null
        }
        $('#add-test').on('click', function() {
            $('.form-wrapper').removeClass('hidden')
        })


        $('#test-result').on('keyup', function() {
            newTest.result = $(this).val()
            console.log(newTest)

        })

        $('#test-name').on('change', function() {
            newTest.name = $(this).val()
            console.log(newTest)
        })

        $('#create-test').on('click', function() {
                if (newTest.name == null) {
                    alert('no input')
                } else {
                    myArray.push({
                        newTest
                    });
                    console.log(newTest)
                    $('#test-name').val('')
                    $('#test-result').val('')
                    $('.form-wrapper').addClass('hidden')
                }
            })
            //le data
        var myArray = [{
                "name": "Mickey Mouse",
                "points": 10
            }, {
                "name": "Donald Duck",
                "points": 34
            }, {
                "name": "Rick Roll",
                "points": 15
            }, {
                "name": "Winnie the Pooh",
                "points": 32
            }, {
                "name": "Harley Quinn",
                "points": 13
            }, {
                "name": "Johnny Bravo",
                "points": 7
            }, {
                "name": "Cristiano Ronaldo",
                "points": 64
            }, {
                "name": "Weighted Companion Cube",
                "points": 115
            }, {
                "name": "The Huddle",
                "points": 34
            }, {
                "name": "Peter Pan",
                "points": 29
            }, {
                "name": "Dirk Gentley",
                "points": 28
            }, {
                "name": "Arthur Ford",
                "points": 61
            }, {
                "name": "Towelie",
                "points": 111
            }, {
                "name": "Eric Cartman",
                "points": 35
            }, {
                "name": "Peter Griffith",
                "points": 89
            }, {
                "name": "Stewie Griffith",
                "points": 5
            }, {
                "name": "Invader Zim",
                "points": 39
            }, {
                "name": "Girrrrr",
                "points": 48
            }, {
                "name": "Woody",
                "points": 44
            }, {
                "name": "Todd Sweeney",
                "points": 26
            }]
            //order by desc or asc event click
        $('th').on('click', function() {
            var column = $(this).data('column')
            var order = $(this).data('order')
            var text = $(this).html()
            text = text.substring(0, text.length - 1)

            if (order == 'desc') {
                $(this).data('order', "asc")
                myArray = myArray.sort((a, b) => a[column] > b[column] ? 1 : -1)
                text += '&#9660'

            } else {
                $(this).data('order', "desc")
                myArray = myArray.sort((a, b) => a[column] < b[column] ? 1 : -1)
                text += '&#9650'

            }
            $(this).html(text)
            buildTable(myArray)
        })

        //search bar

        $('#search-input').on('keyup', function() {
                var value = $(this).val()
                console.log(value) //console logging everything in input

                var data = searchTable(value, myArray)



                buildTable(data)
            })
            //search function

        function searchTable(value, data) {
            var filterData = []
            for (var i = 0; i < data.length; i++) {
                value = value.toLowerCase() //so search doesnt filter on caps
                var name = data[i].name.toLowerCase()
                if (name.includes(value)) {
                    filterData.push(data[i])

                }

            }

            return filterData
        }


        buildTable(myArray)


        function buildTable(data) {
            var table = document.getElementById('myTable')
            var counter = 1;
            table.innerHTML = ''
            for (var i = 0; i < data.length; i++) {
                var row = `<tr class="row-${counter}" id="row">
                                    <td>${counter}</td>
                                    <td>${data[i].name}</td>
                                    <td>${data[i].points}</td>
                                    <td>
                                        <button onclick="deleteTest(${counter})" class="delete">Delete</button>
                                        <button onclick="deleteTest(${counter})" class="Edit">Edit</button>
                                        
                                        </td>
                              </tr>`
                table.innerHTML += row
                counter++;





            }


        }

        function edit() {
            var row = number
            console.log(row);

        }

        function deleteTest(number) {
            var row = number
            console.log(row);
        }
    </script>
</body>

</html>