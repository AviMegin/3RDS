<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="leaderboard.css">

</head>

<body>

    <h1>The Cloud Leaderboard</h1>

    <div> <input id="search-input" class="search" type="text" placeholder="Search..."></div>
    <table class="table">

        <tr class="content">
            <th data-column="rank" data-order="desc">Rank &#9650</th>
            <th data-column="name" data-order="desc">Name &#9650</th>
            <th data-column="points" data-order="desc">Points &#9650</th>
        </tr>

        <tbody id="myTable">

        </tbody>
    </table>

    <script>
        //le data
        var myArray = [{
            "name": "Mickey Mouse",
            "points": 10,
            "id": 1
        }, {
            "name": "Donald Duck",
            "points": 34,
            "id": 2
        }, {
            "name": "Rick Roll",
            "points": 15,
            "id": 3
        }, {
            "name": "Winnie the Pooh",
            "points": 32,
            "id": 4
        }, {
            "name": "Harley Quinn",
            "points": 13,
            "id": 5
        }, {
            "name": "Johnny Bravo",
            "points": 7,
            "id": 6
        }, {
            "name": "Cristiano Ronaldo",
            "points": 64,
            "id": 7
        }, {
            "name": "Weighted Companion Cube",
            "points": 115,
            "id": 8
        }, {
            "name": "The Huddle",
            "points": 34,
            "id": 9
        }, {
            "name": "Peter Pan",
            "points": 29,
            "id": 10
        }, {
            "name": "Dirk Gentley",
            "points": 28,
            "id": 11
        }, {
            "name": "Arthur Ford",
            "points": 61,
            "id": 12
        }, {
            "name": "Towelie",
            "points": 111,
            "id": 13
        }, {
            "name": "Eric Cartman",
            "points": 35,
            "id": 14
        }, {
            "name": "Peter Griffith",
            "points": 89,
            "id": 15
        }, {
            "name": "Stewie Griffith",
            "points": 5,
            "id": 16
        }, {
            "name": "Invader Zim",
            "points": 39,
            "id": 17
        }, {
            "name": "Girrrrr",
            "points": 48,
            "id": 18
        }, {
            "name": "Woody",
            "points": 44,
            "id": 19
        }, {
            "name": "Todd Sweeney",
            "points": 26,
            "id": 20
        }]

        //order by desc or asc event click
        $('th').on('click', function() {
            var column = $(this).data('column')
            var order = $(this).data('order')
            var text = $(this).html()
            text = text.substring(0, text.length - 1)

            if (order == 'desc') {
                $(this).data('order', "asc")
                myArray = myArray.sort((a, b) => a[column] > b[column] ? 1 : -1)
                text += '&#9660'

            } else {
                $(this).data('order', "desc")
                myArray = myArray.sort((a, b) => a[column] < b[column] ? 1 : -1)
                text += '&#9650'

            }
            $(this).html(text)
            buildTable(myArray)
        })

        //search bar

        $('#search-input').on('keyup', function() {
                var value = $(this).val()
                console.log(value) //console logging everything in input

                var data = searchTable(value, myArray)



                buildTable(data)
            })
            //search function

        function searchTable(value, data) {
            var filterData = []
            for (var i = 0; i < data.length; i++) {
                value = value.toLowerCase() //so search doesnt filter on caps
                var name = data[i].name.toLowerCase()
                if (name.includes(value)) {
                    filterData.push(data[i])

                }

            }

            return filterData
        }


        buildTable(myArray)


        function buildTable(data) {
            var table = document.getElementById('myTable')
            var counter = 1;
            table.innerHTML = ''
            for (var i = 0; i < data.length; i++) {
                var row = `<tr>
                                    <td>${counter}</td>
                                    <td>${data[i].name}</td>
                                    <td>${data[i].points}</td>
                                    <td>
                                        <button class="delete" data-testid="${data[i].id}" id="delete-${data[i].id}">Delete</button>
                                        <button class="Edit" data-testid="${data[i].id}"  id="edit-${data[i].id}">Edit</button>
                                        
                                        </td>
                              </tr>`
                table.innerHTML += row
                counter++;


            }
        }

        function edit() {
            var testid = $(this).data('testid')

            var deleteBtn = $('#delete-${data[i].id}')
            var editBtn = $('#edit-${data[i].id}')

        }

        function deleteTest() {


        }
    </script>
</body>

</html>